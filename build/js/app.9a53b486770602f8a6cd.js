webpackJsonp([1],{0:function(t,e,n){var o,i;o=[n(110)],i=function(t){document.addEventListener("DOMContentLoaded",function(){window.app=new t,window.app.start()})}.apply(e,o),!(void 0!==i&&(t.exports=i))},110:function(t,e,n){var o,i;(function(a){"use strict";o=[n(113),n(8),n(3)],i=function(t,e,o){var i=function(){var i=this;this.transportMap=null,this.transportViewModel=null,this.start=function(){e.options={closeButton:!0,timeOut:0,extendedTimeOut:0,tapToDismiss:!1},a.getScript("https://maps.googleapis.com/maps/api/js").done(function(){a.getScript("js/vendor/map-icons.js").done(function(){var e=n(112);i.transportMap=new e,i.transportViewModel=new t(i.transportMap),i.transportMap.initMap(),o.applyBindings(i.transportViewModel)}).fail(function(){e.error("This application relies on Google Maps icons and it can't be loaded! Maybe there is a network issue on your side.")})}).fail(function(){e.error("This application relies on Google Maps and it can't be loaded! Maybe there is a network issue on your side.")})}};return i}.apply(e,o),!(void 0!==i&&(t.exports=i))}).call(e,n(2))},111:function(t,e,n){var o,i;o=[n(5),n(4),n(128),n(126),n(127)],i=function(t,e,n,o,i){var a=function(t){this.stationId=t.station.id,this.stationName=t.station.name,this.locationName=t.location.name,this.coordinate=new r(t.location.coordinate.x,t.location.coordinate.y),this.arrivalDate=e(t.arrival).format("HH:mm")},r=function(t,e){this.x=t,this.y=e},s=function(e,n,o,i){this.id=n,this.map=e,this.checkpoints=t.transform(o.passList,function(t,e){t.push(new a(e))},[]),this.operator=o.operator,this.to=o.to,this.number=o.number,this.color=i,this.markers=[]};return s.prototype.drawConnectingCheckpointsLineOnMapForJourney=function(){var e=t.map(this.checkpoints,function(t){return new n.maps.LatLng({lat:t.coordinate.x,lng:t.coordinate.y})});this.connectingCheckpointsLine=new n.maps.Polyline({path:e,geodesic:!1,strokeColor:this.color,strokeOpacity:1,strokeWeight:2}),this.connectingCheckpointsLine.setMap(this.map)},s.prototype.removeCheckpointsFromMap=function(){this.checkpointsPath.setMap(null)},s.prototype.addMarkers=function(e){var a=this;t(this.checkpoints).forEach(function(t){var r=new o({map:a.map,position:new n.maps.LatLng(t.coordinate.x,t.coordinate.y),icon:{path:i,fillColor:a.color,fillOpacity:1,strokeColor:"",strokeWeight:0,scale:.5},map_icon_label:'<span class="map-icon map-icon-transit-station"></span>'});r.checkpoint=t,a.markers.push(r),void 0!==e.id&&t.stationId===e.id.substring(2)&&(r.setAnimation(n.maps.Animation.BOUNCE),setTimeout(function(){r.setAnimation(null)},1500)),r.infoWindow=new n.maps.InfoWindow({content:"<p>"+t.stationName+"</p><p>"+t.arrivalDate+"</p>"}),r.addListener("click",function(){r.setAnimation(n.maps.Animation.BOUNCE),setTimeout(function(){r.setAnimation(null)},1500),r.infoWindow.open(a.map,r)})})},s.prototype.openInfoWindowForCheckpoint=function(e){var o=this;t(this.markers.forEach(function(t){t.infoWindow.close()}));var i=t.filter(this.markers,function(t){return t.checkpoint.stationId===e.stationId});t(i).forEach(function(t){t.setAnimation(n.maps.Animation.BOUNCE),setTimeout(function(){t.setAnimation(null)},1500),t.infoWindow.open(o.map,t)})},s}.apply(e,o),!(void 0!==i&&(t.exports=i))},112:function(t,e,n){var o,i;(function(a){"use strict";o=[n(5),n(111),n(4),n(106)],i=function(t,e,n,o){var i=function(){var i=this;this.map=null,this.locationQueryUrl="http://transport.opendata.ch/v1/locations",this.stationBoardUrl="http://transport.opendata.ch/v1/stationboard",this.createJourneysForStationboard=function(r,s){var c=i.stationBoardUrl+"?id="+r.id+"&limit=5&datetime="+n(s).format("YYYY-MM-DD hh:mm"),l=a.Deferred();return""===r?l.resolve([]):a.getJSON(c,function(){}).done(function(n){var a=[],r=0;t(n.stationboard).forEach(function(t){var n=o.make_color({saturation:1});a.push(new e(i.map,r++,t,n[0]))}),l.resolve(a)}).fail(function(){l.reject('Data can\'t be loaded, there is an error with the <a href="http://transport.opendata.ch/">Swiss Transport API</a>')}),l},this.initMap=function(){this.map=new google.maps.Map(document.getElementById("map"),{zoom:8,center:new google.maps.LatLng(46.996719,6.935708)})},i.addMarkersAndDrawLinesOfJourneys=function(e,n){t(e).forEach(function(t){t.addMarkers(n),t.drawConnectingCheckpointsLineOnMapForJourney()})},i.centerMapForJourney=function(e){var n=new google.maps.LatLngBounds;void 0!==e&&null!==e&&void 0!==e.checkpoints&&t(e.checkpoints).forEach(function(t){n.extend(new google.maps.LatLng({lat:t.coordinate.x,lng:t.coordinate.y}))}),i.map.fitBounds(n),i.map.panToBounds(n)}};return i}.apply(e,o),!(void 0!==i&&(t.exports=i))}).call(e,n(2))},113:function(t,e,n){var o,i;(function(a){"use strict";o=[n(5),n(4),n(3),n(8),n(115),n(116),n(114)],i=function(t,e,n,o){var i=function(i){var r=this;this.filterStationText=n.observable(""),this.selectedDatetime=n.observable(e()),this.selectedJourney=n.observable(null),this.journeys=n.observable([]),this.selectedStation=n.observable(""),this.selectedCheckpoint=n.observable(null),this.menuOpenState=n.observable(!1),this.showDialog=n.observable(!Boolean(localStorage.getItem("hideModalApplication"))),this.doNotDisplayAnymoreStartupModal=function(){r.showDialog(!0),localStorage.setItem("hideModalApplication",!0)},this.filteredJourneyCheckpoints=n.computed(function(){t(r.journeys.peek()).forEach(function(e){e.connectingCheckpointsLine.setVisible(!1),t(e.markers).forEach(function(t){t.setVisible(!1),t.infoWindow.close()})}),void 0!==r.selectedJourney()&&null!==r.selectedJourney()&&(r.selectedJourney().connectingCheckpointsLine.setVisible(!0),t(r.selectedJourney().markers).forEach(function(t){t.setVisible(!0)}));var e=r.filterStationText().replace(/\s+/g," "),o=[];return null!==r.selectedJourney()&&void 0!==r.selectedJourney()&&(o=n.utils.arrayFilter(r.selectedJourney().checkpoints,function(n){var o=!1;return o=e.length?n.locationName.toUpperCase().indexOf(e.toUpperCase())>=0:!0,t(r.selectedJourney().markers).forEach(function(t){t.checkpoint.stationId===n.stationId&&(t.setVisible(o),o||t.infoWindow.close())}),o})),o},r),this.filteredCheckpoinstCss=function(t){return null!==r.selectedCheckpoint()&&r.selectedCheckpoint().stationId===t.stationId?"checkpoint-selected":""},this.filteredCheckpoinstStyling=function(){return{borderLeftColor:r.selectedJourney().color}},this.journeyStyling=function(t){return t.id===r.selectedJourney().id?{backgroundColor:"#000",borderColor:t.color,borderWidth:"5px",color:"#FFF"}:{borderColor:"#FFF",borderWidth:"3px",backgroundColor:t.color}},this.checkpointClicked=function(t){r.selectedJourney().openInfoWindowForCheckpoint(t),r.selectedCheckpoint(t)},this.loadJourneysForSelectedStationAndDatetime=function(){""!==r.selectedStation()&&i.createJourneysForStationboard(r.selectedStation(),r.selectedDatetime()).done(function(t){i.addMarkersAndDrawLinesOfJourneys(t,r.selectedStation()),r.selectedJourney(t.length>0?t[0]:null),r.journeys(t),i.centerMapForJourney(r.selectedJourney())}).fail(function(t){o.error(t)})},this.selectedStation.subscribe(function(){r.loadJourneysForSelectedStationAndDatetime()}),this.selectedDatetime.subscribe(function(){r.loadJourneysForSelectedStationAndDatetime()}),this.handleHamburgerMenu=function(){this.menuOpenState(!this.menuOpenState()),google.maps.event.trigger(i.map,"resize")},this.contentStyling=n.pureComputed(function(){return r.menuOpenState()?"content col-md-12 col-sm-12 col-xs-12":"content col-md-9 col-sm-9 col-xs-6"}),this.sidebarStyling=n.pureComputed(function(){return r.menuOpenState()?"collapsed":""}),this.changeJourney=function(t){r.selectedCheckpoint(null),r.selectedJourney(t),i.centerMapForJourney(this.selectedJourney())},this.typeaheadOptions={name:"stations",displayKey:"name",limit:10,minLength:0,remote:{url:i.locationQueryUrl+"?query=%query",wildcard:"%query",filter:function(t){return t.stations},transport:function(t,e,n){a.ajax(t.url,t).done(function(t){e(t)}).fail(function(t,e,i){o.error('Data can\'t be loaded, there is an error with the <a href="http://transport.opendata.ch/">Swiss Transport API</a>'),n(i)})}}}};return i}.apply(e,o),!(void 0!==i&&(t.exports=i))}).call(e,n(2))},114:function(t,e,n){var o,i;(function(a){"use strict";o=[n(3),n(7)],i=function(t){t.bindingHandlers.modal={init:function(e,n){a(e).modal({show:!1});var o=n();t.isObservable(o)&&a(e).on("hide.bs.modal",function(){o(!1)}),t.utils.domNodeDisposal.addDisposeCallback(e,function(){a(e).modal("destroy")})},update:function(e,n){var o=n();t.utils.unwrapObservable(o)?a(e).modal("show"):a(e).modal("hide")}}}.apply(e,o),!(void 0!==i&&(t.exports=i))}).call(e,n(2))},115:function(t,e,n){var o,i;(function(a){"use strict";o=[n(7),n(108),n(3),n(4)],i=function(t,e,n){n.bindingHandlers.dateTimePicker={init:function(t,e,o){var i=o().dateTimePickerOptions||{};a(t).datetimepicker(i).on("dp.change",function(t){var o=e();n.isObservable(o)&&o(null===t.date||t.date instanceof Date?t.date:t.date.toDate())}),n.utils.domNodeDisposal.addDisposeCallback(t,function(){var e=a(t).data("DateTimePicker");e&&e.destroy()})},update:function(t,e){var o=a(t).data("DateTimePicker");if(o){var i=n.utils.unwrapObservable(e());i="object"!=typeof i?new Date(parseFloat(i.replace(/[^0-9]/g,""))):i,o.date(i)}}}}.apply(e,o),!(void 0!==i&&(t.exports=i))}).call(e,n(2))},116:function(t,e,n){var o,i;(function(a){"use strict";o=[n(3),n(109)],i=function(t,e){t.bindingHandlers.typeaheadJS={init:function(n,o,i){var r=a(n),s=t.utils.unwrapObservable(o()),c=i(),l=new e({datumTokenizer:e.tokenizers.obj.whitespace(s.displayKey),queryTokenizer:e.tokenizers.whitespace,limit:s.limit,prefetch:s.prefetch,remote:s.remote});r.attr("autocomplete","off").typeahead(null,{name:s.name,displayKey:s.displayKey,source:l.ttAdapter()}).on("typeahead:selected",function(t,e){c.selectedStation(e)})}}}.apply(e,o),!(void 0!==i&&(t.exports=i))}).call(e,n(2))},126:function(t,e){t.exports=Marker},127:function(t,e){t.exports=SQUARE_ROUNDED},128:function(t,e){t.exports=google}});